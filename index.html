<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REZXMODZ AI - Google Gemini Chatbot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #4285f4;
            --secondary: #34a853;
            --accent: #ea4335;
            --warning: #fbbc05;
            --dark: #202124;
            --darker: #171717;
            --light: #ffffff;
            --gray: #5f6368;
            --chat-bg: #0f0f0f;
            --user-msg: #2d2d2d;
            --ai-msg: #1a1a1a;
            --gradient: linear-gradient(135deg, #4285f4, #34a853, #ea4335, #fbbc05);
            --neon-glow: 0 0 10px rgba(66, 133, 244, 0.5),
                         0 0 20px rgba(66, 133, 244, 0.3),
                         0 0 30px rgba(66, 133, 244, 0.1);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--darker);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* CYBERPUNK BACKGROUND */
        .cyber-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(66, 133, 244, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(234, 67, 53, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(52, 168, 83, 0.1) 0%, transparent 50%);
            z-index: -2;
        }

        .grid-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        /* CONTAINER */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* HEADER */
        .header {
            text-align: center;
            padding: 30px 0;
            position: relative;
            margin-bottom: 20px;
        }

        .neon-border {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 5px;
            background: var(--gradient);
            border-radius: 5px;
            filter: drop-shadow(0 0 10px rgba(66, 133, 244, 0.5));
        }

        .header h1 {
            font-family: 'Orbitron', monospace;
            font-size: 3.5rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: var(--neon-glow);
        }

        .header p {
            font-size: 1.1rem;
            color: var(--gray);
            max-width: 600px;
            margin: 0 auto;
        }

        .status-badge {
            display: inline-block;
            background: rgba(52, 168, 83, 0.2);
            color: var(--secondary);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 15px;
            border: 1px solid rgba(52, 168, 83, 0.3);
        }

        /* MAIN LAYOUT */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            flex: 1;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        /* SIDEBAR - SETTINGS */
        .sidebar {
            background: rgba(32, 33, 36, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            height: fit-content;
            position: sticky;
            top: 30px;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            color: var(--primary);
            font-size: 1.3rem;
        }

        .section-title i {
            font-size: 1.5rem;
        }

        /* API KEY INPUT */
        .api-key-container {
            margin-bottom: 25px;
        }

        .api-input-group {
            position: relative;
            margin-bottom: 15px;
        }

        .api-input-group input {
            width: 100%;
            padding: 15px 45px 15px 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(66, 133, 244, 0.3);
            border-radius: 10px;
            color: var(--light);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .api-input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.2);
        }

        .api-input-group .toggle-visibility {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .api-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary), #3367d6);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .api-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(66, 133, 244, 0.3);
        }

        /* SETTINGS */
        .settings-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 25px;
        }

        .setting-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .setting-item label {
            display: block;
            margin-bottom: 8px;
            color: var(--light);
            font-weight: 500;
        }

        .setting-item select,
        .setting-item input[type="range"] {
            width: 100%;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            color: var(--light);
        }

        .range-value {
            display: inline-block;
            margin-left: 10px;
            color: var(--primary);
            font-weight: 600;
        }

        /* PRESETS */
        .presets {
            margin-top: 20px;
        }

        .preset-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .preset-btn {
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            text-align: center;
        }

        .preset-btn:hover {
            background: rgba(66, 133, 244, 0.2);
            border-color: var(--primary);
        }

        /* CHAT CONTAINER */
        .chat-container {
            background: rgba(32, 33, 36, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            height: 75vh;
            overflow: hidden;
        }

        /* CHAT HEADER */
        .chat-header {
            padding: 20px 25px;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-info h3 {
            color: var(--light);
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-stats {
            display: flex;
            gap: 20px;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* MESSAGES CONTAINER */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* CUSTOM SCROLLBAR */
        .messages-container::-webkit-scrollbar {
            width: 8px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        /* MESSAGE BUBBLES */
        .message {
            max-width: 85%;
            padding: 20px;
            border-radius: 18px;
            position: relative;
            animation: messageAppear 0.3s ease-out;
            line-height: 1.6;
        }

        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .user-message {
            align-self: flex-end;
            background: var(--user-msg);
            border-bottom-right-radius: 5px;
            border: 1px solid rgba(66, 133, 244, 0.3);
        }

        .ai-message {
            align-self: flex-start;
            background: var(--ai-msg);
            border-bottom-left-radius: 5px;
            border: 1px solid rgba(52, 168, 83, 0.3);
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 600;
        }

        .user-avatar {
            background: linear-gradient(135deg, var(--primary), #3367d6);
        }

        .ai-avatar {
            background: linear-gradient(135deg, var(--secondary), #2e8b57);
        }

        .message-sender {
            font-weight: 600;
            color: var(--light);
        }

        .message-time {
            font-size: 0.8rem;
            color: var(--gray);
            margin-left: auto;
        }

        .message-content {
            color: var(--light);
            word-wrap: break-word;
        }

        .message-content pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            overflow-x: auto;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .message-content code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .message-content ul,
        .message-content ol {
            padding-left: 20px;
            margin: 10px 0;
        }

        .message-content li {
            margin-bottom: 5px;
        }

        .typing-indicator {
            display: flex;
            gap: 5px;
            padding: 15px 20px;
            background: var(--ai-msg);
            border-radius: 18px;
            align-self: flex-start;
            border: 1px solid rgba(52, 168, 83, 0.3);
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--secondary);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        /* INPUT AREA */
        .input-area {
            padding: 25px;
            background: rgba(0, 0, 0, 0.2);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .input-container {
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        .chat-input {
            width: 100%;
            min-height: 60px;
            max-height: 200px;
            padding: 20px 60px 20px 20px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(66, 133, 244, 0.3);
            border-radius: 15px;
            color: var(--light);
            font-size: 1rem;
            resize: none;
            line-height: 1.5;
            transition: all 0.3s;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.2);
        }

        .input-actions {
            position: absolute;
            right: 15px;
            bottom: 15px;
            display: flex;
            gap: 10px;
        }

        .input-action-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.3s;
        }

        .input-action-btn:hover {
            color: var(--primary);
        }

        .send-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), #3367d6);
            border: none;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .send-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(66, 133, 244, 0.3);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* QUICK ACTIONS */
        .quick-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .quick-action-btn {
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: var(--light);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-action-btn:hover {
            background: rgba(66, 133, 244, 0.2);
            border-color: var(--primary);
        }

        /* MODAL */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-content {
            background: var(--dark);
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            padding: 30px;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            color: var(--light);
            line-height: 1.6;
        }

        /* STATS BAR */
        .stats-bar {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
            }
            
            .message {
                max-width: 95%;
            }
            
            .chat-container {
                height: 65vh;
            }
        }

        /* ANIMATIONS */
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <!-- BACKGROUND -->
    <div class="cyber-bg"></div>
    <div class="grid-lines"></div>
    
    <!-- MODAL -->
    <div class="modal" id="apiModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-key"></i> API Key Required</h3>
                <button class="close-modal" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body">
                <p>To use REZXMODZ AI, you need a Google Gemini API key:</p>
                <ol style="margin: 15px 0; padding-left: 20px;">
                    <li>Go to <a href="https://makersuite.google.com/app/apikey" target="_blank" style="color: var(--primary);">Google AI Studio</a></li>
                    <li>Sign in with your Google account</li>
                    <li>Click "Get API Key" → "Create API Key"</li>
                    <li>Copy your API key and paste it below</li>
                </ol>
                <div class="api-input-group">
                    <input type="password" id="modalApiKey" placeholder="Paste your API key here...">
                    <button class="toggle-visibility" onclick="toggleVisibility('modalApiKey')">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <button class="api-btn" onclick="saveApiKeyFromModal()" style="margin-top: 20px;">
                    <i class="fas fa-save"></i> Save API Key
                </button>
                <p style="margin-top: 15px; font-size: 0.9rem; color: var(--gray);">
                    <i class="fas fa-shield-alt"></i> Your API key is stored locally and never sent to our servers.
                </p>
            </div>
        </div>
    </div>
    
    <!-- MAIN CONTAINER -->
    <div class="container">
        <!-- HEADER -->
        <header class="header">
            <div class="neon-border"></div>
            <h1>REZXMODZ AI</h1>
            <p>© ᴄʀᴇᴀᴛᴏʀ ʙʏ ʀᴇᴢxᴍᴏᴅᴢ</p>
            <div class="status-badge" id="statusBadge">
                <i class="fas fa-circle"></i> <span id="statusText">ᴀᴋᴛɪғ ᴀɴᴊɪɴɢ</span>
            </div>
        </header>
        
        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- SIDEBAR -->
            <aside class="sidebar">
                <!-- API SECTION -->
                <div class="section-title">
                    <i class="fas fa-key"></i>
                    <h3>API Configuration</h3>
                </div>
                
                <div class="api-key-container">
                    <div class="api-input-group">
                        <input type="password" id="apiKeyInput" placeholder="Enter Google Gemini API Key...">
                        <button class="toggle-visibility" onclick="toggleVisibility('apiKeyInput')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <button class="api-btn" onclick="saveApiKey()">
                        <i class="fas fa-save"></i> Save & Connect
                    </button>
                    <button class="api-btn" onclick="openModal()" style="margin-top: 10px; background: linear-gradient(135deg, var(--gray), #5f6368);">
                        <i class="fas fa-question-circle"></i> Get API Key
                    </button>
                </div>
                
                <!-- MODEL SETTINGS -->
                <div class="section-title">
                    <i class="fas fa-sliders-h"></i>
                    <h3>AI Settings</h3>
                </div>
                
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>Model: <span id="modelValue" class="range-value">ɢᴇᴍɪɴɪ-</span></label>
                        <select id="modelSelect" onchange="updateModel()">
                            <option value="gemini-pro">Gemini Pro (Default)</option>
                            <option value="gemini-pro-vision">Gemini Pro Vision</option>
                        </select>
                    </div>
                    
                    <div class="setting-item">
                        <label>Temperature: <span id="tempValue" class="range-value">0.7</span></label>
                        <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7" oninput="updateTemperature()">
                    </div>
                    
                    <div class="setting-item">
                        <label>Max Tokens: <span id="tokensValue" class="range-value">1000</span></label>
                        <input type="range" id="maxTokens" min="100" max="2000" step="100" value="1000" oninput="updateTokens()">
                    </div>
                    
                    <div class="setting-item">
                        <label>Response Style</label>
                        <select id="responseStyle">
                            <option value="balanced">Balanced</option>
                            <option value="creative">Creative</option>
                            <option value="precise">Precise</option>
                        </select>
                    </div>
                </div>
                
                <!-- PRESETS -->
                <div class="section-title">
                    <i class="fas fa-bolt"></i>
                    <h3>Quick Presets</h3>
                </div>
                
                <div class="presets">
                    <div class="preset-buttons">
                        <button class="preset-btn" onclick="loadPreset('coding')">
                            <i class="fas fa-code"></i> Coding
                        </button>
                        <button class="preset-btn" onclick="loadPreset('creative')">
                            <i class="fas fa-paint-brush"></i> Creative
                        </button>
                        <button class="preset-btn" onclick="loadPreset('analysis')">
                            <i class="fas fa-chart-line"></i> Analysis
                        </button>
                        <button class="preset-btn" onclick="loadPreset('casual')">
                            <i class="fas fa-comments"></i> Casual
                        </button>
                    </div>
                </div>
                
                <!-- STATS -->
                <div class="section-title" style="margin-top: 25px;">
                    <i class="fas fa-chart-bar"></i>
                    <h3>Session Stats</h3>
                </div>
                
                <div class="stats-bar">
                    <div class="stat-item">
                        <i class="fas fa-message"></i>
                        <span id="messageCount">0</span> msgs
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-bolt"></i>
                        <span id="tokenCount">0</span> tokens
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-clock"></i>
                        <span id="timeActive">0m</span>
                    </div>
                </div>
            </aside>
            
            <!-- CHAT CONTAINER -->
            <main class="chat-container">
                <!-- CHAT HEADER -->
                <div class="chat-header">
                    <div class="chat-info">
                        <h3>
                            <i class="fas fa-robot"></i>
                            ʀᴇᴢxᴍᴏᴅᴢ ᴀɪ
                        </h3>
                    </div>
                    <div class="chat-stats">
                        <div class="stat-item">
                            <i class="fas fa-database"></i>
                            <span id="modelBadge">ɢᴇᴍɪɴɪ</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-wifi"></i>
                            <span id="connectionStatus">ᴄᴏɴɴᴇᴄᴛᴇᴅ</span>
                        </div>
                    </div>
                </div>
                
                <!-- MESSAGES -->
                <div class="messages-container" id="messagesContainer">
                    <!-- Messages will be added here dynamically -->
                    <div class="ai-message message">
                        <div class="message-header">
                            <div class="message-avatar ai-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="message-sender">REZXMODZ AI</div>
                            <div class="message-time">Just now</div>
                        </div>
                        <div class="message-content">
                            <p>ʜᴇʟʟᴏ ɪᴍ ʀᴇᴢxᴍᴏᴅᴢ ᴀɪ ᴄʀᴇᴀᴛᴏʀ ʙʏ sʏᴀʜʀᴇᴢᴀ ʜᴀʙɪʙɪ  .</p>
                            <p>Enter your API key in the sidebar to start chatting, or click "Get API Key" for instructions.</p>
                            <p><strong>Quick tips:</strong></p>
                            <ul>
                                <li>Ask me anything - coding, writing, analysis, etc.</li>
                                <li>Use code blocks by wrapping with triple backticks</li>
                                <li>Adjust settings in the sidebar for different responses</li>
                                <li>Try presets for specific use cases</li>
                            </ul>
                            <p>What would you like to explore today?</p>
                        </div>
                    </div>
                </div>
                
                <!-- INPUT AREA -->
                <div class="input-area">
                    <div class="input-container">
                        <div class="input-wrapper">
                            <textarea 
                                class="chat-input" 
                                id="chatInput" 
                                placeholder="Type your message here... (Shift+Enter for new line, Enter to send)"
                                rows="1"
                                onkeydown="handleInputKeydown(event)"
                                oninput="autoResize(this)"></textarea>
                            <div class="input-actions">
                                <button class="input-action-btn" onclick="attachFile()">
                                    <i class="fas fa-paperclip"></i>
                                </button>
                                <button class="input-action-btn" onclick="clearChat()">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <button class="send-btn" id="sendBtn" onclick="sendMessage()" disabled>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    
                    <!-- QUICK ACTIONS -->
                    <div class="quick-actions">
                        <button class="quick-action-btn" onclick="insertQuickPrompt('Explain quantum computing')">
                            <i class="fas fa-atom"></i> Quantum
                        </button>
                        <button class="quick-action-btn" onclick="insertQuickPrompt('Write Python code for Fibonacci')">
                            <i class="fas fa-code"></i> Python
                        </button>
                        <button class="quick-action-btn" onclick="insertQuickPrompt('Summarize this article:')">
                            <i class="fas fa-file-alt"></i> Summarize
                        </button>
                        <button class="quick-action-btn" onclick="insertQuickPrompt('Translate to Indonesian:')">
                            <i class="fas fa-language"></i> Translate
                        </button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // ==================== GLOBAL VARIABLES ====================
        let apiKey = localStorage.getItem('gemini_api_key') || '';
        let messages = [];
        let isConnected = false;
        let isTyping = false;
        let messageCount = 0;
        let tokenCount = 0;
        let sessionStartTime = Date.now();
        let currentModel = 'gemini-pro';
        let temperature = 0.7;
        let maxTokens = 1000;
        
        // ==================== DOM ELEMENTS ====================
        const messagesContainer = document.getElementById('messagesContainer');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const apiKeyInput = document.getElementById('apiKeyInput');
        const statusBadge = document.getElementById('statusBadge');
        const statusText = document.getElementById('statusText');
        const apiModal = document.getElementById('apiModal');
        const modelBadge = document.getElementById('modelBadge');
        const messageCountEl = document.getElementById('messageCount');
        const tokenCountEl = document.getElementById('tokenCount');
        const timeActiveEl = document.getElementById('timeActive');
        const connectionStatus = document.getElementById('connectionStatus');
        
        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved API key
            if (apiKey) {
                apiKeyInput.value = apiKey;
                updateConnectionStatus(true);
                sendBtn.disabled = false;
            }
            
            // Load saved settings
            loadSettings();
            
            // Update stats every minute
            setInterval(updateStats, 60000);
            updateStats();
            
            // Auto-focus input
            setTimeout(() => chatInput.focus(), 1000);
        });
        
        // ==================== API FUNCTIONS ====================
        async function callGeminiAPI(prompt) {
            if (!apiKey) {
                showError('API key is required. Please enter your Google Gemini API key.');
                openModal();
                return null;
            }
            
            try {
                // Show typing indicator
                showTypingIndicator();
                
                // Add user message to history
                messages.push({
                    role: 'user',
                    parts: [{ text: prompt }]
                });
                
                // Prepare request
                const requestBody = {
                    contents: messages,
                    generationConfig: {
                        temperature: temperature,
                        maxOutputTokens: maxTokens,
                        topP: 0.95,
                        topK: 40
                    },
                    safetySettings: [
                        {
                            category: "HARM_CATEGORY_HARASSMENT",
                            threshold: "BLOCK_MEDIUM_AND_ABOVE"
                        },
                        {
                            category: "HARM_CATEGORY_HATE_SPEECH",
                            threshold: "BLOCK_MEDIUM_AND_ABOVE"
                        },
                        {
                            category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                            threshold: "BLOCK_MEDIUM_AND_ABOVE"
                        },
                        {
                            category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                            threshold: "BLOCK_MEDIUM_AND_ABOVE"
                        }
                    ]
                };
                
                // Make API call
                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/${currentModel}:generateContent?key=${apiKey}`,
                    {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(requestBody)
                    }
                );
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || `API Error: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Remove typing indicator
                removeTypingIndicator();
                
                // Extract AI response
                const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || 
                                  "I apologize, but I couldn't generate a response.";
                
                // Add AI message to history
                messages.push({
                    role: 'model',
                    parts: [{ text: aiResponse }]
                });
                
                // Update token count
                const estimatedTokens = Math.ceil(aiResponse.length / 4);
                tokenCount += estimatedTokens;
                
                return aiResponse;
                
            } catch (error) {
                console.error('Gemini API Error:', error);
                removeTypingIndicator();
                showError(`API Error: ${error.message}`);
                return null;
            }
        }
        
        // ==================== CHAT FUNCTIONS ====================
        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            
            // Add user message to UI
            addMessageToUI(message, 'user');
            
            // Clear input
            chatInput.value = '';
            autoResize(chatInput);
            
            // Disable send button while processing
            sendBtn.disabled = true;
            chatInput.disabled = true;
            
            // Call Gemini API
            callGeminiAPI(message).then(response => {
                if (response) {
                    addMessageToUI(response, 'ai');
                    messageCount += 2;
                    updateStats();
                }
                
                // Re-enable input
                sendBtn.disabled = false;
                chatInput.disabled = false;
                chatInput.focus();
                
            }).catch(error => {
                console.error('Error:', error);
                sendBtn.disabled = false;
                chatInput.disabled = false;
                chatInput.focus();
            });
        }
        
        function addMessageToUI(content, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const timestamp = new Date().toLocaleTimeString([], { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            const senderName = sender === 'user' ? 'You' : 'REZXMODZ AI';
            const avatarIcon = sender === 'user' ? 'fas fa-user' : 'fas fa-robot';
            const avatarClass = sender === 'user' ? 'user-avatar' : 'ai-avatar';
            
            // Format code blocks and lists
            const formattedContent = formatMessage(content);
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-avatar ${avatarClass}">
                        <i class="${avatarIcon}"></i>
                    </div>
                    <div class="message-sender">${senderName}</div>
                    <div class="message-time">${timestamp}</div>
                </div>
                <div class="message-content">${formattedContent}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            scrollToBottom();
        }
        
        function formatMessage(text) {
            // Convert markdown-like formatting to HTML
            let formatted = text
                // Code blocks
                .replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>')
                // Inline code
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                // Bold
                .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
                // Italic
                .replace(/\*([^*]+)\*/g, '<em>$1</em>')
                // Lists
                .replace(/^\s*[-*]\s+(.+)$/gm, '<li>$1</li>')
                // Headers
                .replace(/^###\s+(.+)$/gm, '<h3>$1</h3>')
                .replace(/^##\s+(.+)$/gm, '<h2>$1</h2>')
                .replace(/^#\s+(.+)$/gm, '<h1>$1</h1>');
            
            // Wrap list items in ul if needed
            if (formatted.includes('<li>')) {
                formatted = formatted.replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>');
            }
            
            // Convert line breaks to paragraphs
            const paragraphs = formatted.split('\n\n');
            formatted = paragraphs.map(p => {
                if (!p.startsWith('<') && p.trim()) {
                    return `<p>${p}</p>`;
                }
                return p;
            }).join('');
            
            return formatted;
        }
        
        function showTypingIndicator() {
            if (isTyping) return;
            
            isTyping = true;
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            scrollToBottom();
        }
        
        function removeTypingIndicator() {
            isTyping = false;
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        // ==================== UI FUNCTIONS ====================
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';
            
            // Enable/disable send button
            sendBtn.disabled = !textarea.value.trim();
        }
        
        function handleInputKeydown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                if (!sendBtn.disabled) {
                    sendMessage();
                }
            }
        }
        
        function scrollToBottom() {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function toggleVisibility(inputId) {
            const input = document.getElementById(inputId);
            const button = input.nextElementSibling;
            
            if (input.type === 'password') {
                input.type = 'text';
                button.innerHTML = '<i class="fas fa-eye-slash"></i>';
            } else {
                input.type = 'password';
                button.innerHTML = '<i class="fas fa-eye"></i>';
            }
        }
        
        // ==================== SETTINGS FUNCTIONS ====================
        function saveApiKey() {
            apiKey = apiKeyInput.value.trim();
            if (!apiKey) {
                showError('Please enter a valid API key');
                return;
            }
            
            localStorage.setItem('gemini_api_key', apiKey);
            updateConnectionStatus(true);
            sendBtn.disabled = false;
            
            showNotification('API key saved successfully!', 'success');
            
            // Test connection
            testConnection();
        }
        
        function testConnection() {
            showNotification('Testing API connection...', 'info');
            
            // Simple test request
            fetch(`https://generativelanguage.googleapis.com/v1beta/models/${currentModel}?key=${apiKey}`)
                .then(response => {
                    if (response.ok) {
                        updateConnectionStatus(true);
                        showNotification('Connected to Gemini API!', 'success');
                    } else {
                        updateConnectionStatus(false);
                        showError('Failed to connect. Please check your API key.');
                    }
                })
                .catch(error => {
                    updateConnectionStatus(false);
                    showError('Connection failed: ' + error.message);
                });
        }
        
        function updateConnectionStatus(connected) {
            isConnected = connected;
            
            if (connected) {
                statusBadge.style.background = 'rgba(52, 168, 83, 0.2)';
                statusBadge.style.borderColor = 'rgba(52, 168, 83, 0.3)';
                statusText.innerHTML = '<i class="fas fa-circle"></i> Connected';
                connectionStatus.textContent = 'Connected';
                connectionStatus.style.color = 'var(--secondary)';
            } else {
                statusBadge.style.background = 'rgba(234, 67, 53, 0.2)';
                statusBadge.style.borderColor = 'rgba(234, 67, 53, 0.3)';
                statusText.innerHTML = '<i class="fas fa-circle"></i> Disconnected';
                connectionStatus.textContent = 'Disconnected';
                connectionStatus.style.color = 'var(--accent)';
            }
        }
        
        function updateModel() {
            const select = document.getElementById('modelSelect');
            currentModel = select.value;
            modelBadge.textContent = currentModel;
            localStorage.setItem('gemini_model', currentModel);
        }
        
        function updateTemperature() {
            const slider = document.getElementById('temperature');
            const valueSpan = document.getElementById('tempValue');
            temperature = parseFloat(slider.value);
            valueSpan.textContent = temperature;
            localStorage.setItem('gemini_temperature', temperature);
        }
        
        function updateTokens() {
            const slider = document.getElementById('maxTokens');
            const valueSpan = document.getElementById('tokensValue');
            maxTokens = parseInt(slider.value);
            valueSpan.textContent = maxTokens;
            localStorage.setItem('gemini_max_tokens', maxTokens);
        }
        
        function loadSettings() {
            // Load model
            const savedModel = localStorage.getItem('gemini_model');
            if (savedModel) {
                currentModel = savedModel;
                document.getElementById('modelSelect').value = savedModel;
                modelBadge.textContent = savedModel;
            }
            
            // Load temperature
            const savedTemp = localStorage.getItem('gemini_temperature');
            if (savedTemp) {
                temperature = parseFloat(savedTemp);
                document.getElementById('temperature').value = savedTemp;
                document.getElementById('tempValue').textContent = savedTemp;
            }
            
            // Load max tokens
            const savedTokens = localStorage.getItem('gemini_max_tokens');
            if (savedTokens) {
                maxTokens = parseInt(savedTokens);
                document.getElementById('maxTokens').value = savedTokens;
                document.getElementById('tokensValue').textContent = savedTokens;
            }
        }
        
        // ==================== PRESET FUNCTIONS ====================
        function loadPreset(presetName) {
            const presets = {
                coding: {
                    temperature: 0.2,
                    maxTokens: 1500,
                    style: 'precise'
                },
                creative: {
                    temperature: 0.9,
                    maxTokens: 2000,
                    style: 'creative'
                },
                analysis: {
                    temperature: 0.1,
                    maxTokens: 1000,
                    style: 'precise'
                },
                casual: {
                    temperature: 0.7,
                    maxTokens: 500,
                    style: 'balanced'
                }
            };
            
            const preset = presets[presetName];
            if (preset) {
                // Update sliders
                document.getElementById('temperature').value = preset.temperature;
                document.getElementById('maxTokens').value = preset.maxTokens;
                document.getElementById('responseStyle').value = preset.style;
                
                // Update values
                updateTemperature();
                updateTokens();
                
                showNotification(`Loaded ${presetName} preset`, 'info');
            }
        }
        
        function insertQuickPrompt(prompt) {
            chatInput.value = prompt;
            autoResize(chatInput);
            sendBtn.disabled = false;
            chatInput.focus();
        }
        
        // ==================== MODAL FUNCTIONS ====================
        function openModal() {
            apiModal.style.display = 'flex';
        }
        
        function closeModal() {
            apiModal.style.display = 'none';
        }
        
        function saveApiKeyFromModal() {
            const modalKey = document.getElementById('modalApiKey').value.trim();
            if (modalKey) {
                apiKeyInput.value = modalKey;
                saveApiKey();
                closeModal();
            }
        }
        
        // ==================== UTILITY FUNCTIONS ====================
        function clearChat() {
            if (confirm('Clear all chat messages?')) {
                messages = [];
                messagesContainer.innerHTML = '';
                messageCount = 0;
                tokenCount = 0;
                
                // Add initial AI message
                addMessageToUI("Chat cleared. How can I help you today?", 'ai');
                updateStats();
            }
        }
        
        function attachFile() {
            // This would handle file uploads for Gemini Pro Vision
            showNotification('File upload feature coming soon!', 'info');
        }
        
        function updateStats() {
            const minutesActive = Math.floor((Date.now() - sessionStartTime) / 60000);
            
            messageCountEl.textContent = messageCount;
            tokenCountEl.textContent = tokenCount.toLocaleString();
            timeActiveEl.textContent = `${minutesActive}m`;
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: ${type === 'error' ? 'var(--accent)' : 
                           type === 'success' ? 'var(--secondary)' : 'var(--primary)'};
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 1000;
                animation: slideIn 0.3s, slideOut 0.3s 2.7s;
                font-weight: 600;
                max-width: 300px;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.remove(), 3000);
        }
        
        function showError(message) {
            showNotification(message, 'error');
        }
        
        // Add CSS for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // ==================== EXPORT/IMPORT ====================
        function exportChat() {
            const chatData = {
                messages: messages,
                settings: {
                    model: currentModel,
                    temperature: temperature,
                    maxTokens: maxTokens
                },
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(chatData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', `gemini-chat-${new Date().toISOString().split('T')[0]}.json`);
            link.click();
            
            showNotification('Chat exported successfully!', 'success');
        }
        
        function importChat(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const chatData = JSON.parse(e.target.result);
                    
                    // Import messages
                    if (chatData.messages) {
                        messages = chatData.messages;
                        
                        // Clear and reload UI
                        messagesContainer.innerHTML = '';
                        messages.forEach(msg => {
                            if (msg.role === 'user') {
                                addMessageToUI(msg.parts[0].text, 'user');
                            } else if (msg.role === 'model') {
                                addMessageToUI(msg.parts[0].text, 'ai');
                            }
                        });
                        
                        messageCount = messages.length;
                        updateStats();
                        showNotification('Chat imported successfully!', 'success');
                    }
                } catch (error) {
                    showError('Failed to import chat file');
                }
            };
            reader.readAsText(file);
        }
        
        // ==================== KEYBOARD SHORTCUTS ====================
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + / for help
            if ((e.ctrlKey || e.metaKey) && e.key === '/') {
                e.preventDefault();
                openModal();
            }
            
            // Ctrl/Cmd + K to clear
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                clearChat();
            }
            
            // Ctrl/Cmd + E to export
            if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                e.preventDefault();
                exportChat();
            }
            
            // Ctrl/Cmd + I to import
            if ((e.ctrlKey || e.metaKey) && e.key === 'i') {
                e.preventDefault();
                document.getElementById('fileImport').click();
            }
        });
        
        // Add import input
        const importInput = document.createElement('input');
        importInput.type = 'file';
        importInput.accept = '.json';
        importInput.id = 'fileImport';
        importInput.style.display = 'none';
        importInput.onchange = importChat;
        document.body.appendChild(importInput);
        
        // Add export button to sidebar
        const sidebar = document.querySelector('.sidebar');
        const exportBtn = document.createElement('button');
        exportBtn.className = 'api-btn';
        exportBtn.innerHTML = '<i class="fas fa-download"></i> Export Chat';
        exportBtn.onclick = exportChat;
        exportBtn.style.marginTop = '10px';
        sidebar.appendChild(exportBtn);
    </script>
</body>
</html>